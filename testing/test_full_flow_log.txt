[2026-01-16 21:55:01] [INFO] ============================================================
[2026-01-16 21:55:01] [INFO] Full Flow Label Automation Test
[2026-01-16 21:55:01] [INFO] ============================================================
[2026-01-16 21:55:01] [INFO] Test started at: 2026-01-16 21:55:01
[2026-01-16 21:55:01] [INFO] 
[2026-01-16 21:55:01] [INFO] Item number: '6401-1167T'
[2026-01-16 21:55:01] [INFO] Lot number: '900114574'
[2026-01-16 21:55:01] [INFO] Production number: '900114574'
[2026-01-16 21:55:01] [INFO] 
[2026-01-16 21:55:01] [INFO] Found Tesseract at: C:\Users\3649287\AppData\Local\Programs\Tesseract-OCR\tesseract.exe
[2026-01-16 21:55:01] [INFO] Configured pytesseract to use: C:\Users\3649287\AppData\Local\Programs\Tesseract-OCR\tesseract.exe
[2026-01-16 21:55:01] [INFO] Setting up Edge browser in Internet Explorer mode...
[2026-01-16 21:55:10] [INFO] Browser started successfully
[2026-01-16 21:55:10] [INFO] 
[2026-01-16 21:55:10] [INFO] ============================================================
[2026-01-16 21:55:10] [INFO] STEP 1: Logging in to enLabel
[2026-01-16 21:55:10] [INFO] ============================================================
[2026-01-16 21:55:10] [INFO] Navigating to login URL: https://pallprod.enlabel.com/Login.aspx?ReturnUrl=%2f
[2026-01-16 21:55:11] [INFO] Login page loaded successfully
[2026-01-16 21:55:12] [INFO] Entering username...
[2026-01-16 21:55:13] [INFO] Username entered: 'mariusg' (verified: 'mariusg')
[2026-01-16 21:55:14] [INFO] Entering password...
[2026-01-16 21:55:16] [INFO] Password entered: 21 characters
[2026-01-16 21:55:17] [INFO] Clicking login button...
[2026-01-16 21:55:22] [INFO] Login completed. Current page: enLabel Global Services
[2026-01-16 21:55:22] [INFO] Current URL: https://pallprod.enlabel.com/CommonComponents/MyAccount/AccountInfo.aspx?mode=view&restorePanelBarFromUrl=True
[2026-01-16 21:55:22] [INFO] 
============================================================
[2026-01-16 21:55:22] [INFO] STEP 2: Navigating to label search page
[2026-01-16 21:55:22] [INFO] ============================================================
[2026-01-16 21:55:22] [INFO] Navigating to label search URL: https://pallprod.enlabel.com/ProductionPrint/PrintTypes/PrintByOrder/PrintStart.aspx?ServiceId=10
[2026-01-16 21:55:23] [INFO] Label search page loaded
[2026-01-16 21:55:23] [INFO] Production number input field found
[2026-01-16 21:55:23] [INFO] 
============================================================
[2026-01-16 21:55:23] [INFO] STEP 3: Entering production number: 900114574
[2026-01-16 21:55:23] [INFO] ============================================================
[2026-01-16 21:55:26] [INFO] Value in input field: '900114574'
[2026-01-16 21:55:26] [INFO] ✓ Production number entered successfully
[2026-01-16 21:55:26] [INFO] 
============================================================
[2026-01-16 21:55:26] [INFO] STEP 4: Clicking search/next button
[2026-01-16 21:55:26] [INFO] ============================================================
[2026-01-16 21:55:26] [INFO] Looking for search button (ID: ctl00_MainContent__btnNext)...
[2026-01-16 21:55:36] [WARNING] Search button not found by ID, trying alternative methods...
[2026-01-16 21:55:38] [INFO] Clicking search button...
[2026-01-16 21:55:38] [INFO] Waiting for results to load...
[2026-01-16 21:55:41] [INFO] ✓ Search button clicked
[2026-01-16 21:55:41] [INFO] 
============================================================
[2026-01-16 21:55:41] [INFO] STEP 5: Extracting result rows
[2026-01-16 21:55:41] [INFO] ============================================================
[2026-01-16 21:55:41] [INFO] Found result row 0
[2026-01-16 21:55:42] [INFO] Found result row 1
[2026-01-16 21:55:42] [INFO] Found result row 2
[2026-01-16 21:55:42] [INFO] Found 3 result row(s)
[2026-01-16 21:55:42] [INFO] 
============================================================
[2026-01-16 21:55:42] [INFO] STEP 6: Clicking preview button for result row 0
[2026-01-16 21:55:42] [INFO] ============================================================
[2026-01-16 21:55:42] [INFO] Looking for preview button (ID: ctl00_MainContent_gridLabels_ctl00_ctl04_btnPreview)...
[2026-01-16 21:55:43] [INFO] Found preview button: ctl00_MainContent_gridLabels_ctl00_ctl04_btnPreview
[2026-01-16 21:55:43] [INFO] Clicking preview button...
[2026-01-16 21:55:43] [INFO] Preview button clicked, waiting for preview window to open...
[2026-01-16 21:55:48] [INFO] ✓ Preview button click completed
[2026-01-16 21:55:48] [INFO] 
============================================================
[2026-01-16 21:55:48] [INFO] STEP 7: Finding preview window
[2026-01-16 21:55:48] [INFO] ============================================================
[2026-01-16 21:55:48] [INFO] ✓ Found preview window:
[2026-01-16 21:55:48] [INFO]     Title: 'enLabel Global Services - Profile 1 - Microsoft​ Edge'
[2026-01-16 21:55:48] [INFO]     Class: 'Chrome_WidgetWin_1'
[2026-01-16 21:55:48] [INFO] 
============================================================
[2026-01-16 21:55:48] [INFO] STEP 8: Resizing preview window
[2026-01-16 21:55:48] [INFO] ============================================================
[2026-01-16 21:55:48] [INFO] Dragging window from (850, 827) to (1450, 868)
[2026-01-16 21:55:49] [INFO] ✓ Window resize completed
[2026-01-16 21:55:50] [INFO] 
============================================================
[2026-01-16 21:55:50] [INFO] STEP 9: Clicking zoom in button 3 times
[2026-01-16 21:55:50] [INFO] ============================================================
[2026-01-16 21:55:50] [INFO]   Click 1/3 at (540, 420)
[2026-01-16 21:55:50] [INFO]   Click 2/3 at (540, 420)
[2026-01-16 21:55:50] [INFO]   Click 3/3 at (540, 420)
[2026-01-16 21:55:51] [INFO] ✓ Clicked zoom in button 3 times
[2026-01-16 21:55:51] [INFO] 
============================================================
[2026-01-16 21:55:51] [INFO] STEP 10: Extracting text using OCR
[2026-01-16 21:55:51] [INFO] ============================================================
[2026-01-16 21:55:51] [INFO] Capturing screenshot of preview window...
[2026-01-16 21:55:51] [INFO] Screenshot saved to: C:\Projects\fifra-automation-cytiva\testing\label_verification_screenshot_20260116_215551.png
[2026-01-16 21:55:51] [INFO] Preprocessing image for OCR...
[2026-01-16 21:55:51] [INFO] Extracting text using OCR...
[2026-01-16 21:55:51] [INFO] ✓ Successfully extracted text using OCR (559 characters)
[2026-01-16 21:55:51] [INFO] Extracted text preview: '= © enlabel Global Services - Profile 1 - Microsoft Edge - a x
K & | @_ hitps,//pallprod.enlabel.com/Collaboration/ServiceForms/PreviewDocumentaspx?labelld=2663706RlabelName=6401-1167T_NLO2_Allegro_ 1...'
[2026-01-16 21:55:51] [INFO] 
============================================================
[2026-01-16 21:55:51] [INFO] STEP 11: Verifying label content
[2026-01-16 21:55:51] [INFO] ============================================================
[2026-01-16 21:55:51] [INFO] 
============================================================
[2026-01-16 21:55:51] [INFO] VERIFICATION: Item Number
[2026-01-16 21:55:51] [INFO] ============================================================
[2026-01-16 21:55:51] [INFO] Expected item number: '6401-1167T'
[2026-01-16 21:55:51] [INFO] ✓ Item number found in text
[2026-01-16 21:55:51] [INFO] 
============================================================
[2026-01-16 21:55:51] [INFO] VERIFICATION: Lot Number
[2026-01-16 21:55:51] [INFO] ============================================================
[2026-01-16 21:55:51] [INFO] Expected lot number: '900114574'
[2026-01-16 21:55:51] [INFO] ✓ Lot number found in text
[2026-01-16 21:55:51] [INFO] 
============================================================
[2026-01-16 21:55:51] [INFO] VERIFICATION: EPA Number
[2026-01-16 21:55:51] [INFO] ============================================================
[2026-01-16 21:55:51] [ERROR] ✗ 'EPA' not found
[2026-01-16 21:55:51] [INFO] 
============================================================
[2026-01-16 21:55:51] [INFO] VERIFICATION SUMMARY
[2026-01-16 21:55:51] [INFO] ============================================================
[2026-01-16 21:55:51] [INFO] Item Number: ✓ PASS
[2026-01-16 21:55:51] [INFO] Lot Number: ✓ PASS
[2026-01-16 21:55:51] [INFO] EPA Number: ✗ FAIL
[2026-01-16 21:55:51] [INFO] 
[2026-01-16 21:55:51] [ERROR] ✗ VERIFICATION FAILED - Label does not match expected values
[2026-01-16 21:55:51] [ERROR] Aborting print operation
[2026-01-16 21:55:51] [INFO] 
[2026-01-16 21:55:51] [INFO] ============================================================
[2026-01-16 21:55:51] [INFO] ✗ TEST FAILED
[2026-01-16 21:55:51] [INFO] ============================================================
[2026-01-16 21:55:51] [INFO] Closing browser...
