[2026-01-16 21:38:27] [INFO] ============================================================
[2026-01-16 21:38:27] [INFO] Preview Window Test Script (Image Matching + Coordinate Approach)
[2026-01-16 21:38:27] [INFO] ============================================================
[2026-01-16 21:38:27] [INFO] Test started at: 2026-01-16 21:38:27
[2026-01-16 21:38:27] [INFO] 
[2026-01-16 21:38:27] [INFO] IMPORTANT: This script assumes a preview window is already open.
[2026-01-16 21:38:27] [INFO] Please open a label preview window before continuing.
[2026-01-16 21:38:27] [INFO] 
[2026-01-16 21:38:27] [INFO] NOTE: This script will resize the window, zoom in, then click the PRINT button.
[2026-01-16 21:38:27] [INFO] The button is in the enLabel application toolbar (below the browser chrome).
[2026-01-16 21:38:27] [INFO] 
[2026-01-16 21:38:28] [INFO] 
[2026-01-16 21:38:28] [INFO] 
============================================================
[2026-01-16 21:38:28] [INFO] STEP 1: Finding preview window
[2026-01-16 21:38:28] [INFO] ============================================================
[2026-01-16 21:38:28] [INFO] ✓ Found window by class pattern 'Chrome_WidgetWin_1':
[2026-01-16 21:38:28] [INFO]     Title: 'enLabel Global Services - Work - Microsoft​ Edge'
[2026-01-16 21:38:28] [INFO]     Class: 'Chrome_WidgetWin_1'
[2026-01-16 21:38:28] [INFO] Found 2 monitor(s)
[2026-01-16 21:38:28] [INFO] Window center: (648, 548)
[2026-01-16 21:38:28] [INFO] Monitor 1: left=0, top=0, right=1920, bottom=1080, width=1920, height=1080
[2026-01-16 21:38:28] [INFO] ✓ Window is on Monitor 1
[2026-01-16 21:38:28] [INFO] Window rectangle: left=440, top=262, width=416, height=572
[2026-01-16 21:38:28] [INFO] ✓ Screenshot captured: 416x572 pixels
[2026-01-16 21:38:28] [INFO] Screenshot saved to: C:\Projects\fifra-automation-cytiva\testing\preview_window_screenshot_20260116_213828.png
[2026-01-16 21:38:28] [INFO] 
============================================================
[2026-01-16 21:38:28] [INFO] STEP 2b: Attempting button region detection in enLabel toolbar
[2026-01-16 21:38:28] [INFO] ============================================================
[2026-01-16 21:38:28] [INFO] Attempting to detect button regions with OpenCV...
[2026-01-16 21:38:28] [INFO] Searching in enLabel application toolbar area (below browser chrome)...
[2026-01-16 21:38:28] [INFO] Searching for buttons in region: y=150 to 230
[2026-01-16 21:38:28] [INFO]   Found potential button region at (72, 219), size: 59x22
[2026-01-16 21:38:28] [INFO]   Found potential button region at (53, 161), size: 17x15
[2026-01-16 21:38:28] [INFO]   Found potential button region at (140, 161), size: 17x16
[2026-01-16 21:38:28] [INFO]   Found potential button region at (100, 161), size: 17x16
[2026-01-16 21:38:28] [INFO] Detected 4 potential button regions in enLabel toolbar
[2026-01-16 21:38:28] [INFO] 
============================================================
[2026-01-16 21:38:28] [INFO] STEP 3: Resizing preview window
[2026-01-16 21:38:28] [INFO] ============================================================
[2026-01-16 21:38:28] [INFO] Dragging window from bottom-right corner (850, 827) to (1450, 868)
[2026-01-16 21:38:30] [INFO] ✓ Window resize completed (dragged from (850, 827) to (1450, 868))
[2026-01-16 21:38:31] [INFO] 
============================================================
[2026-01-16 21:38:31] [INFO] STEP 4: Clicking zoom in button 3 times
[2026-01-16 21:38:31] [INFO] ============================================================
[2026-01-16 21:38:31] [INFO] Zoom in button coordinates: (540, 420)
[2026-01-16 21:38:31] [INFO]   Click 1/3 at (540, 420)
[2026-01-16 21:38:31] [INFO]   Click 2/3 at (540, 420)
[2026-01-16 21:38:32] [INFO]   Click 3/3 at (540, 420)
[2026-01-16 21:38:32] [INFO] ✓ Clicked zoom in button 3 times
[2026-01-16 21:38:33] [INFO] Using detected leftmost region for 'print' button: (53, 161)
[2026-01-16 21:38:33] [INFO] 
============================================================
[2026-01-16 21:38:33] [INFO] STEP 6: Clicking print button at coordinates
[2026-01-16 21:38:33] [INFO] ============================================================
[2026-01-16 21:38:33] [INFO] Window position: (440, 262)
[2026-01-16 21:38:33] [INFO] Button relative position: (53, 161)
[2026-01-16 21:38:33] [INFO] Absolute click coordinates: (493, 423)
[2026-01-16 21:38:34] [INFO] ✓ Clicked print button at (493, 423)
[2026-01-16 21:38:36] [INFO] 
============================================================
[2026-01-16 21:38:36] [INFO] STEP 7: Handling printer selection dialog
[2026-01-16 21:38:36] [INFO] ============================================================
[2026-01-16 21:38:38] [INFO] Found printer dialog: 'Print'
[2026-01-16 21:38:38] [INFO] Typing 'Microsoft Print to PDF' to select printer...
[2026-01-16 21:38:42] [INFO] Pressing Alt+O to click OK button...
[2026-01-16 21:38:43] [INFO] Pressing Enter to confirm (OK button may be focused)...
[2026-01-16 21:38:45] [INFO] ✓ Printer selection confirmed (dialog should be closed)
[2026-01-16 21:38:45] [INFO] 
[2026-01-16 21:39:07] [INFO] 
[2026-01-16 21:39:07] [INFO] ============================================================
[2026-01-16 21:39:07] [INFO] Test completed
[2026-01-16 21:39:07] [INFO] ============================================================
[2026-01-16 21:39:07] [INFO] 
[2026-01-16 21:39:07] [INFO] TROUBLESHOOTING:
[2026-01-16 21:39:07] [INFO] If the print button was not clicked correctly:
[2026-01-16 21:39:07] [INFO] 1. The script uses absolute coordinates (493, 421) for the print button
[2026-01-16 21:39:07] [INFO] 2. If your window is in a different position, update ABSOLUTE_PRINT_COORDS
[2026-01-16 21:39:07] [INFO]    in the get_button_coordinates() function
[2026-01-16 21:39:07] [INFO] 
[2026-01-16 21:39:07] [INFO] If the printer dialog did not work:
[2026-01-16 21:39:07] [INFO] 1. The script types 'Microsoft Print to PDF' and presses Enter
[2026-01-16 21:39:07] [INFO] 2. Make sure 'Microsoft Print to PDF' is installed on your system
[2026-01-16 21:39:07] [INFO] 3. The script will try Alt+O and Enter to confirm the selection
